$(document).ready(function () {
    // 在表单提交时触发事件
    $('#regedit').submit(function (event) {
        // 阻止表单默认的提交行为
        event.preventDefault();
        sendData(); // 调用发送数据的函数
    });
});

// 获取表单数据并转换为 JSON 格式
function sendData() {
    var form = $('#regedit');
    var jsonData = form.serializeArray();
    var convertedJSON = {};

    $.each(jsonData, function () {
        if (this.name === "use_ipcard") {
            convertedJSON["use_ipcard"] = this.value;
        } else {
            convertedJSON[this.name] = this.value;
        }
    });

    // 发送 Ajax 请求
    $.ajax({
        type: "post", // 请求类型，可以是 GET 或 POST
        url: '/api/Page/regedit', // 后端处理数据的 URL
        data: JSON.stringify(convertedJSON), // 要发送的数据
        contentType: "application/json",
        // 请求成功时的回调函数
        success: function (response) {
            var message = '';
            if (response.status === true) {
                message = '注册成功！';
                alert(message);
                window.location.href = "/index";
            } else if (response.status === "user_exists") {
                message = '注册失败，该用户和真实姓名已存在！';
                alert(message);
            } else {
                message = '注册失败！';
                alert(message);
            }
        },
        // 请求失败时的回调函数
        error: function () {
            var message = '注册失败，该用户真实姓名已存在';
            alert(message);
        }
    });
}